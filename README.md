OCR 기반 매크로입니다 (숫자 0에서 n으로 변할 시 클릭)
여석 감시·자동 신청 매크로 (Python)
=================================

브라우저 화면의 특정 영역을 스크린샷 → OCR로 “여석(잔여 수)” 숫자를 읽고,
조건을 만족하면 지정한 좌표를 클릭하여 수강신청 버튼을 자동 클릭하는 스크립트입니다.

⚠️ 주의/면책
------------
- 본 스크립트 사용은 해당 웹사이트/기관의 이용약관·정책·캡차·자동화 금지 규정에 위배되지 않는 범위에서만 사용하세요.
- 과도한 요청으로 서비스에 피해를 주지 않도록 합리적인 새로고침 주기를 설정하세요.
- 모든 책임은 사용자 본인에게 있습니다.

---------------------------------
1. 주요 기능
---------------------------------
- 영역 지정: 마우스로 좌상단/우하단을 찍어 장바구니 탭, 각 과목 여석 영역, 신청 버튼을 JSON으로 저장
- 자동 새로고침 및 탭 클릭: F5 → 장바구니 탭 클릭으로 목록 갱신
- OCR 판독: EasyOCR 기반 숫자 전용 인식 (전처리: 확대·블러·이진화)
- 오탈자 보정: O/o → 0, I/l → 1 치환 후 숫자 추출
- 조건부 클릭: 여석 ≥ 1일 경우 자동으로 신청 버튼 클릭 + Enter
- 긴급 종료: ESC 키 또는 Ctrl+C
- 이미지 로그 저장: 원본/전처리 스크린샷을 `remainder_shots/`에 저장

---------------------------------
2. 실행 흐름
---------------------------------
1) 실행 시 기존 `macro_boxes.json` 삭제 후 위치 재지정
2) 신청할 과목 수 입력
3) 각 과목 여석 영역, 신청 버튼 좌표를 직접 지정
4) 3초 후 루프 시작 → 여석 판독 및 조건부 신청
5) ESC 키로 종료

---------------------------------
3. 요구 사항
---------------------------------
- OS: Windows
- Python: 3.9 이상 권장
- 권한: keyboard 라이브러리 사용 시 관리자 권한 필요할 수 있음
- 디스플레이: 주 모니터 기준, 윈도우 배율은 100% 권장
- 의존 패키지:
  - pyautogui, keyboard, easyocr, opencv-python, numpy, pillow

---------------------------------
4. 설치 방법
---------------------------------
# 가상환경 생성 (권장)
python -m venv .venv
.venv\Scripts\activate

# 필수 패키지 설치
pip install --upgrade pip
pip install pyautogui keyboard easyocr opencv-python numpy pillow

# (선택) PyTorch 설치 필요 시
# https://pytorch.org/get-started/locally/ 참고

---------------------------------
5. 실행 방법
---------------------------------
python main.py

- 콘솔 안내에 따라 장바구니 탭/여석 영역/신청 버튼을 지정
- 신청할 과목 수 입력
- 이후 자동 루프 실행 (ESC로 종료)

---------------------------------
6. 파일 구조
---------------------------------
project-root/

 ├─ main.py
 
 ├─ macro_boxes.json         # 위치/영역 설정 (자동 생성/갱신)
 
 └─ remainder_shots/         # OCR 원본/전처리 이미지 저장 폴더

---------------------------------
7. 내부 동작 요약
---------------------------------
- wait_region_settle(): 새로고침 후 화면 안정화 대기
- preprocess_for_ocr(): 확대·블러·이진화 전처리
- extract_number_from_ocr(): EasyOCR 결과에서 숫자만 추출
- run(): 전체 루프 실행

---------------------------------
8. FAQ
---------------------------------
Q1. OCR이 잘못 인식돼요.
 → 여석 영역을 숫자만 포함하도록 타이트하게 지정하세요. 대비가 높은 테마를 추천합니다.

Q2. 새로고침 후 반영이 늦게 돼요.
 → wait_region_settle() 파라미터 또는 sleep 시간을 늘리세요.

Q3. ESC가 안 먹어요.
 → 관리자 권한으로 실행하세요.

Q4. 좌표가 어긋나요.
 → 주 모니터에서 실행하고 배율을 100%로 맞추세요.

---------------------------------
